<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Document</title>
</head>
<body>
  <h2 id="version"></h2>
  <h2 id="userAgent"></h2>
  <script type="text/javascript">
  // matching browser rules
  var BrowserMap = [
    {
      regex: /opr/i,
      key: 'opr',
      matched: 'Opera'
    },
    {
      regex: /compatible/i,
      key: 'compatible',
      matched: 'IE'
    },
    {
      regex: /msie/i,
      key: 'msies',
      matched: 'IE'
    },
    {
      regex: /edge/i,
      key: 'edge',
      matched: 'Edge'
    },
    {
      regex: /ucbrowser/i,
      key: 'ucbrowser',
      matched: 'UC'
    },
    {
      regex: /firefox/i,
      key: 'firefox',
      matched: 'Firefox'
    },
    {
      regex: /micromessenger/i,
      key: "micromessenger",
      matched: 'Wechat'
    },
    {
      regex: /qqbrowser/i,
      key: 'qqbrowser',
      matched: 'QQbrowser'
    },
    {
      regex: /chrome/i,
      key: 'chrome',
      matched: 'Chrome'
    },
    {
      regex: /safari/i,
      key: 'safari',
      matched: 'Safari'
    },
  ]
  // matching platform rules
  var platforms = [
    {
      regex: /android/,
      matched: 'Android'
    },
    {
      regex: /iphone/,
      matched: 'iphone'
    },
    {
      regex: /ipad/,
      matched: 'ipad'
    }
  ]

  var userAgent = navigator.userAgent.toLowerCase();

  function getBrowserName() {
    var name = "";
    var key = "";
    for(var i in BrowserMap){
      if(name == "" && userAgent.match(BrowserMap[i].regex)){
        name = BrowserMap[i].matched;
        key = BrowserMap[i].key;
      }
    }
    return  { name: name, key: key}
  }

  function getBrowserVersion(){
    var Browser = getBrowserName();
    var Version = ""
    switch (Browser.name) {
      case "IE":
        if (!window.XMLHttpRequest) {
          Version = "6";
        }else if (!window.document.querySelector){
          Version = "7";
        }else if (!window.document.addEventListener) {
          Version = "8";
        }else if (!window.atob) {
          Version = "9";
        } else if (!document.createElement ("input").dataset) {
          Version = "10"; 
        }
        break;
      case "":
        if(!!window.ActiveXObject || "ActiveXObject" in window){
          Browser.name = "IE";
          Version = "11";
        } else {
          Browser = "unkonwn";
          Version = "unkonwn";
        } 
        break;
      default:
        Version = userAgent.split(Browser.key + "/")[1].split(" ")[0];
        break;
    }
    return Version;
  }

  function getPlatform(){
    var Platform = "";
    for(var j in platforms){
      if( Platform == "" && userAgent.match(platforms[j].regex)){
        Platform = platforms[j].matched;
      }
    }
   return Platform == "" ? "PC" : Platform;
  }

  var getBrowserInfo = function(){
    return {
      name: getBrowserName().name,
      version: getBrowserVersion(),
      platform: getPlatform()
    }
  }

  var BrowserInfo = getBrowserInfo();

  window.onload=function(){
    document.getElementById("version").innerHTML = BrowserInfo.name  + BrowserInfo.version + BrowserInfo.platform;
    document.getElementById("userAgent").innerHTML = navigator.userAgent.toLowerCase()
    console.log(navigator.userAgent.toLowerCase());
  }
  </script>
</body>
</html>
